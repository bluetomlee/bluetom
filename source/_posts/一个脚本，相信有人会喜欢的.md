title: "一个脚本，相信有人会喜欢的"
date: 2011-08-06 20:05:06
tags:
---

<div>

### 继Google+、Youtube、Facebook和Twitter小鸟都被hosts大法攻破之后，言冬整理了一份HOSTS文件，使用下面的批处理可以直接更新，如果言冬的HOSTS有更新，也会在这里调用的源文件中同步更新的。呵呵，不解释了。

### 对了，请确认你是使用的WIN系统哦，然后，系统没有被另类的装载到C盘以外的其他盘子，呵呵。

### 如果，你是那个另类的吧系统装载到C盘以外其他盘子的人呢，那么，请吧下面代码中的“C:”替换成你的系统盘，OK？

### ![](http://img003.photo.21cn.com/photos/game/20080710/s160x120/57B5B4A08A310B52F490A751F986243E.jpg "呵呵")

### 把以下代码保存成文件名以 [ .VBS ] 结尾的批处理文件（例如：更新 [ Hosts.vbs ] ），然后执行就OK了，记得看提示框哦！呵呵～

### 

### ps:[http://hosts.fgqi.net/](http://hosts.fgqi.net/)

### 如果你的hosts自己手动修改过（不含用VBS代码加载的），请不要使用脚本加载！请[点击这里](http://labs.gengu.org/FuckWall/HostsForIPV4/)查看hosts文件的内容并手动将内容写入hosts文件！

&nbsp;</div>
<pre lang="LANGUAGE"> '重命名原hosts以做备份
Set fso = CreateObject("Scripting.FileSystemObject")
set f=fso.getfile("C:\WINDOWS\system32\drivers\etc\hosts")
BackupName="hosts" &amp; Year(Now) &amp; Month(Now) &amp; day(Now) &amp; Hour(Now) &amp; Minute(Now) &amp; Second(Now) &amp; "Backup"
f.name=BackupName
msgbox "原文件已经备份为C:\WINDOWS\system32\drivers\etc\" &amp; BackupName  &amp; chr(13) &amp; chr(13) &amp; "如果脚本执行期间出现问题，可以重命名该文件为hosts以恢复备份。" &amp; chr(13) &amp; chr(13) &amp; "按下确定，继续执行脚本"

'执行hosts远程更新
Set Post = CreateObject("Msxml2.XMLHTTP")
Set Shell = CreateObject("Wscript.Shell")
Post.Open "GET","[https://smarthosts.googlecode.com/svn/trunk/hosts](https://smarthosts.googlecode.com/svn/trunk/hosts)/",0
Post.Send()
Set aGet = CreateObject("ADODB.Stream")
aGet.Mode = 3
aGet.Type = 1
aGet.Open()
aGet.Write(Post.responseBody)
aGet.SaveToFile "C:\WINDOWS\system32\drivers\etc\hosts",2
wscript.sleep 1000
msgbox "脚本执行完毕，理论上Google+，Youtube，Facebook和Twitter都可以浏览了。" &amp; chr(13) &amp; chr(13) &amp; "提示：如果依然无法访问，请使用https加密协议试试看。"
msgbox "请查看hosts文件是否成功的从服务器加载到本地，文本顶端类似" &amp; chr(13) &amp; "# ============================================================" &amp; chr(13) &amp; "#" &amp; chr(13) &amp; "# 加载时间:20110101" &amp; chr(13) &amp; "#" &amp; chr(13) &amp; "# 更新日期:20110101" &amp; chr(13) &amp; "#" &amp; chr(13) &amp; "# ============================================================" &amp; chr(13) &amp; "的文本内容中，若加载日期为今天，那么hosts文件已经成功加载。" &amp; chr(13) &amp; chr(13) &amp; "若没有成功加载，请重命名备份文件为hosts后重新执行本脚本。"
set obj=createobject("wscript.Shell")
obj.Run "c:\windows\system32\notepad.exe C:\WINDOWS\system32\drivers\etc\hosts"</pre>

&nbsp;</p>