<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <title>一个脚本，相信有人会喜欢的 | Bluetom</title>
  <meta name="description" content="" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" type="text/css" href="/css/screen.css" />
  <link rel="stylesheet" type="text/css" href="/css/style.css" />
  <meta name="generator" content="Bluetom">

  
  
  

  
</head>

<!--
<body class="post-template">
-->
<body class="home-template">
<div id="perspective" class="perspective effect-movedown">
  <div class="container">
    <!-- wrapper -->
    <div class="wrapper">

      <header class="site-head" style="background-image: url(/img/img-bg.jpg)">
    <div class="vertical">
        <div class="site-head-content inner">
             <a class="blog-logo" style="display:none" href="/"><img src="/img/logo.svg" alt="Blog Logo"></a> 
            <h1 class="blog-title"><a href="/">Bluetom</a></h1>
            <h2 class="blog-description"><button id="showMenu">Show Menu</button></h2>
        </div>
    </div>
</header>

      

<main class="content" role="main">
  <article class="post">
    <span class="post-meta">
      <time datetime="2011-08-06T12:05:06.000Z" itemprop="datePublished">
          2011-08-06
      </time>
    
</span>
    <h3 class="post-title">一个脚本，相信有人会喜欢的</h3>
    <section class="post-content" style="margin-top: 10px;">
      <div>

<h3 id="继Google-、Youtube、Facebook和Twitter小鸟都被hosts大法攻破之后，言冬整理了一份HOSTS文件，使用下面的批处理可以直接更新，如果言冬的HOSTS有更新，也会在这里调用的源文件中同步更新的。呵呵，不解释了。"><a href="#继Google-、Youtube、Facebook和Twitter小鸟都被hosts大法攻破之后，言冬整理了一份HOSTS文件，使用下面的批处理可以直接更新，如果言冬的HOSTS有更新，也会在这里调用的源文件中同步更新的。呵呵，不解释了。" class="headerlink" title="继Google+、Youtube、Facebook和Twitter小鸟都被hosts大法攻破之后，言冬整理了一份HOSTS文件，使用下面的批处理可以直接更新，如果言冬的HOSTS有更新，也会在这里调用的源文件中同步更新的。呵呵，不解释了。"></a>继Google+、Youtube、Facebook和Twitter小鸟都被hosts大法攻破之后，言冬整理了一份HOSTS文件，使用下面的批处理可以直接更新，如果言冬的HOSTS有更新，也会在这里调用的源文件中同步更新的。呵呵，不解释了。</h3><h3 id="对了，请确认你是使用的WIN系统哦，然后，系统没有被另类的装载到C盘以外的其他盘子，呵呵。"><a href="#对了，请确认你是使用的WIN系统哦，然后，系统没有被另类的装载到C盘以外的其他盘子，呵呵。" class="headerlink" title="对了，请确认你是使用的WIN系统哦，然后，系统没有被另类的装载到C盘以外的其他盘子，呵呵。"></a>对了，请确认你是使用的WIN系统哦，然后，系统没有被另类的装载到C盘以外的其他盘子，呵呵。</h3><h3 id="如果，你是那个另类的吧系统装载到C盘以外其他盘子的人呢，那么，请吧下面代码中的“C-”替换成你的系统盘，OK？"><a href="#如果，你是那个另类的吧系统装载到C盘以外其他盘子的人呢，那么，请吧下面代码中的“C-”替换成你的系统盘，OK？" class="headerlink" title="如果，你是那个另类的吧系统装载到C盘以外其他盘子的人呢，那么，请吧下面代码中的“C:”替换成你的系统盘，OK？"></a>如果，你是那个另类的吧系统装载到C盘以外其他盘子的人呢，那么，请吧下面代码中的“C:”替换成你的系统盘，OK？</h3><h3 id=""><a href="#" class="headerlink" title=""></a><img src="http://img003.photo.21cn.com/photos/game/20080710/s160x120/57B5B4A08A310B52F490A751F986243E.jpg" alt="" title="呵呵"></h3><h3 id="把以下代码保存成文件名以-VBS-结尾的批处理文件（例如：更新-Hosts-vbs-），然后执行就OK了，记得看提示框哦！呵呵～"><a href="#把以下代码保存成文件名以-VBS-结尾的批处理文件（例如：更新-Hosts-vbs-），然后执行就OK了，记得看提示框哦！呵呵～" class="headerlink" title="把以下代码保存成文件名以 [ .VBS ] 结尾的批处理文件（例如：更新 [ Hosts.vbs ] ），然后执行就OK了，记得看提示框哦！呵呵～"></a>把以下代码保存成文件名以 [ .VBS ] 结尾的批处理文件（例如：更新 [ Hosts.vbs ] ），然后执行就OK了，记得看提示框哦！呵呵～</h3><p>### </p>
<h3 id="ps-http-hosts-fgqi-net"><a href="#ps-http-hosts-fgqi-net" class="headerlink" title="ps:http://hosts.fgqi.net/"></a>ps:<a href="http://hosts.fgqi.net/" target="_blank" rel="noopener">http://hosts.fgqi.net/</a></h3><h3 id="如果你的hosts自己手动修改过（不含用VBS代码加载的），请不要使用脚本加载！请点击这里查看hosts文件的内容并手动将内容写入hosts文件！"><a href="#如果你的hosts自己手动修改过（不含用VBS代码加载的），请不要使用脚本加载！请点击这里查看hosts文件的内容并手动将内容写入hosts文件！" class="headerlink" title="如果你的hosts自己手动修改过（不含用VBS代码加载的），请不要使用脚本加载！请点击这里查看hosts文件的内容并手动将内容写入hosts文件！"></a>如果你的hosts自己手动修改过（不含用VBS代码加载的），请不要使用脚本加载！请<a href="http://labs.gengu.org/FuckWall/HostsForIPV4/" target="_blank" rel="noopener">点击这里</a>查看hosts文件的内容并手动将内容写入hosts文件！</h3><p>&nbsp;</p></div><p></p>
<pre lang="LANGUAGE"> '重命名原hosts以做备份
Set fso = CreateObject("Scripting.FileSystemObject")
set f=fso.getfile("C:\WINDOWS\system32\drivers\etc\hosts")
BackupName="hosts" &amp; Year(Now) &amp; Month(Now) &amp; day(Now) &amp; Hour(Now) &amp; Minute(Now) &amp; Second(Now) &amp; "Backup"
f.name=BackupName
msgbox "原文件已经备份为C:\WINDOWS\system32\drivers\etc\" &amp; BackupName  &amp; chr(13) &amp; chr(13) &amp; "如果脚本执行期间出现问题，可以重命名该文件为hosts以恢复备份。" &amp; chr(13) &amp; chr(13) &amp; "按下确定，继续执行脚本"

'执行hosts远程更新
Set Post = CreateObject("Msxml2.XMLHTTP")
Set Shell = CreateObject("Wscript.Shell")
Post.Open "GET","[https://smarthosts.googlecode.com/svn/trunk/hosts](https://smarthosts.googlecode.com/svn/trunk/hosts)/",0
Post.Send()
Set aGet = CreateObject("ADODB.Stream")
aGet.Mode = 3
aGet.Type = 1
aGet.Open()
aGet.Write(Post.responseBody)
aGet.SaveToFile "C:\WINDOWS\system32\drivers\etc\hosts",2
wscript.sleep 1000
msgbox "脚本执行完毕，理论上Google+，Youtube，Facebook和Twitter都可以浏览了。" &amp; chr(13) &amp; chr(13) &amp; "提示：如果依然无法访问，请使用https加密协议试试看。"
msgbox "请查看hosts文件是否成功的从服务器加载到本地，文本顶端类似" &amp; chr(13) &amp; "# ============================================================" &amp; chr(13) &amp; "#" &amp; chr(13) &amp; "# 加载时间:20110101" &amp; chr(13) &amp; "#" &amp; chr(13) &amp; "# 更新日期:20110101" &amp; chr(13) &amp; "#" &amp; chr(13) &amp; "# ============================================================" &amp; chr(13) &amp; "的文本内容中，若加载日期为今天，那么hosts文件已经成功加载。" &amp; chr(13) &amp; chr(13) &amp; "若没有成功加载，请重命名备份文件为hosts后重新执行本脚本。"
set obj=createobject("wscript.Shell")
obj.Run "c:\windows\system32\notepad.exe C:\WINDOWS\system32\drivers\etc\hosts"</pre>

<p>&nbsp;</p><p></p>

    </section>
    <footer class="post-footer">
      <section class="author">
    <h4>Bluetom</h4>
    <p>作为挨踢业的前段湿 搬过砖也画过画：爱看、爱听、爱玩儿、爱折腾、爱打撸啊撸、intj</p>
</section>
      <section class="share">
    <h4>Share this post</h4>
    <a class="icon-sina-weibo" href="http://v.t.sina.com.cn/share/share.php?title=作为挨踢业的前段湿 搬过砖也画过画：爱看、爱听、爱玩儿、爱折腾、爱打撸啊撸、intj ?url=http://bluetomlee.github.io/2011/08/06/一个脚本，相信有人会喜欢的/" target="_blank">
        <span class="hidden">weibo</span>
    </a>
    <a class="icon-twitter" href="http://twitter.com/share?url=http://bluetomlee.github.io/2011/08/06/一个脚本，相信有人会喜欢的/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
        <span class="hidden">Twitter</span>
    </a>
    <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://bluetomlee.github.io/2011/08/06/一个脚本，相信有人会喜欢的/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
        <span class="hidden">Facebook</span>
    </a>
    <a class="icon-google-plus" href="https://plus.google.com/share?url=http://bluetomlee.github.io/2011/08/06/一个脚本，相信有人会喜欢的/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
        <span class="hidden">Google+</span>
    </a>
</section>

    </footer>
  </article>
  <nav class="pagination" role="pagination">
    
    <a class="newer-posts" href="/2011/08/17/读天才在左-疯子在右/">
        ← 读天才在左 疯子在右
    </a>
    
    <span class="icon-logo">•</span>
    
    <a class="older-posts" href="/2011/08/06/论体验/">
        论体验 →
    </a>
    
</nav>

  <div id="vcomments" class="comments-area">
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
    <script>
        new Valine({
            el: '#vcomments',
            appId: 'uqOF3JaDTxGcM3W3isHHVq9Y-gzGzoHsz',
            appKey: 'h3C2CLvdTKRJ46HQG1SyjW1Y',
            avatar:'mp',
            placeholder: '说点什么'
        })
    </script>
  </div>

</main>


      
<footer class="site-footer">
  
  <div class="inner">
     <section class="copyright">All content copyright <a href="/">Bluetom</a> &copy; 2014 &bull; All rights reserved.</section>
     <section class="poweredby">Proudly published with <a class="icon-ghost" href="http://zespia.tw/hexo/">Hexo</a></section>
  </div>
</footer>

      <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<script type="text/javascript" src="/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/js/index.js"></script>
<script type="text/javascript" src="/js/menu.js"></script>

<script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-72355167-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>





  </div>
</div>

<nav  class="outer-nav top horizontal">

          <a class="icon-home"  href="/"><span>Home</span></a>

          <a class="icon-news"  href="/archive"><span>Archive</span></a>

          <a class="icon-image"  href="/images"><span>Images</span></a>

          <a class="icon-mail"  href="/about/"><span>Contact</span></a>

</nav>

</div>
</body>
</html>
